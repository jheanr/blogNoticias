trigger:
  branches:
    include:
      - testcontainers

jobs:
  - job: build_and_test
    displayName: Build and Test
    pool:
      vmImage: 'ubuntu-latest'

    steps:
      - checkout: self

      - task: UseDotNet@2
        displayName: Setup .NET
        inputs:
          packageType: 'sdk'
          version: '6.x'

      - task: DotNetCoreCLI@2
        displayName: Restore dependencies
        inputs:
          command: 'restore'
          projects: '**/*.csproj'

      - task: DotNetCoreCLI@2
        displayName: Build
        inputs:
          command: 'build'
          projects: '**/*.csproj'
          arguments: '--configuration Release'

      - task: DotNetCoreCLI@2
        displayName: Run tests
        inputs:
          command: 'test'
          projects: '**/*.csproj'
          arguments: '--configuration Release'